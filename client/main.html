<head>
  <title>Extra Medium</title>
</head>

<body>
  {{> header}}
  {{> main}}
</body>

<template name="header">
  <header>
    <h1>Extra Medium</h1>
    <div class="description">
      // Restore collections to their former glory by providing a third-party replacement<br>
      // In case you forgot the old goodness:
      <ul>
        <li>posts can belong to multiple collections</li>
        <li>open submission of posts to collections</li>
      </ul>
    </div>
    {{> loginButtons}}
  </header>
</template>

<template name="main">
  <div id="main">
    <div id="listContainer">
      <h1>Collections</h1>
      <ul class="collectionsList">
        {{#each collections}}
          {{> collectionItem}}
        {{/each}}
      </ul>
      {{> insertCollectionForm}}
    </div>
    <div id="collection">
      {{> UI.dynamic template="collection" data=selectedCollection}}
      {{> insertPostForm}}
    </div>
  </div>
</template>

<template name="collectionItem">
  <li class="collectionItem">
    <div class="info">
      <div class="name">{{name}}</div>
      <button class="follow">
        {{followLabel}} | {{followerCount}} 
      </button>
    </div>
  </li>
</template>

<template name="collection">
  <p>Collection: {{name}}</p>
  <p>Description: {{description}}</p>
  <p>Owner: {{owner.profile.name}}</p>
  <hr>
  <p>Posts:</p>
  {{#each posts}}
    <p>
      <a href="{{url}}" target="_blank">{{title}}</a>
      <div class="subtitle">{{subtitle}}</div>
    </p>
  {{/each}}
</template>

<template name="insertCollectionForm">
  {{#if currentUser}}
    {{#autoForm collection="Collections" id="insertCollectionForm" type="insert"}}
      <fieldset>
        <legend>New Collection</legend>
        {{> afQuickField name='name'}}
        {{> afQuickField name='description'}}
      </fieldset>
      <button type="submit" class="btn btn-primary">Create</button>
    {{/autoForm}}
  {{/if}}
</template>

<template name="insertPostForm">
  {{#if currentUser}}
    {{#autoForm collection="Posts" id="insertPostForm" type="insert"}}
      <fieldset>
        <legend>{{addOrSubmit}} a Post</legend>
        {{> afQuickField name='title'}}
        {{> afQuickField name='subtitle'}}
        {{> afQuickField name='url'}}
      </fieldset>
      <button type="submit" class="btn btn-primary">{{addOrSubmit}}</button>
    {{/autoForm}}
  {{/if}}
</template>
