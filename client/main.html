<head>
  <title>Extra Medium</title>
</head>

<body>
  {{> header}}
  {{> main}}
</body>

<template name="header">
  <header>
    <div id="banner">
      <img src="xm.png" />
      <div class="container">
        <div class="title">Extra Medium</div>
        <div class="info secondaryFont">
          Do you miss Medium's old collection functionality? This app aims to restore/replace it.
        </div>
      </div>
      {{> loginButtons}}
    </div>
  </header>
</template>

<template name="main">
  <div id="main">
    <div id="listContainer">
      <h1>Collections</h1>
      <ul class="collectionsList">
        {{#each collections}}
          {{> collectionItem}}
        {{/each}}
      </ul>
      {{> insertCollectionForm}}
    </div>
    <div id="collection">
      {{#if selectedCollection}}
        {{> UI.dynamic template="collection" data=selectedCollection}}
        {{> insertArticleForm}}
      {{/if}}
    </div>
  </div>
</template>

<template name="collectionItem">
  <li class="collectionItem">
    <div class="info">
      <div class="name">{{name}}</div>
      <button class="follow">
        {{followLabel}} | {{followerCount}} 
      </button>
    </div>
  </li>
</template>

<template name="collection">
  <p>Collection: {{name}}</p>
  <p>Description: {{description}}</p>
  <p>Owner: {{owner.profile.name}}</p>
  <hr>
  <p>Articles:</p>
  {{#each articles}}
    <p>
      <a href="{{url}}" target="_blank">{{title}}</a>
      <div class="subtitle">{{subtitle}}</div>
    </p>
  {{/each}}
</template>

<template name="insertCollectionForm">
  {{#if currentUser}}
    {{#autoForm collection="Collections" id="insertCollectionForm" type="insert"}}
      <fieldset>
        <legend>New Collection</legend>
        {{> afQuickField name='name'}}
        {{> afQuickField name='description'}}
      </fieldset>
      <button type="submit" class="btn btn-primary">Create</button>
    {{/autoForm}}
  {{/if}}
</template>

<template name="insertArticleForm">
  {{#if currentUser}}
    {{#autoForm collection="Articles" id="insertArticleForm" type="insert"}}
      <fieldset>
        <legend>{{addOrSubmit}} an Article</legend>
        {{> afQuickField name='title'}}
        {{> afQuickField name='subtitle'}}
        {{> afQuickField name='url'}}
      </fieldset>
      <button type="submit" class="btn btn-primary">{{addOrSubmit}}</button>
    {{/autoForm}}
  {{/if}}
</template>
